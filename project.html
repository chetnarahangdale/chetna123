<!DOCTYPE html>
<html>
<head>
    <title>Digital Dukan</title>
   <style>

    body{
    font-family: Arial;
    background: #f2f2f2;
    padding: 20px;
}

.container{
    display: flex;
    gap: 40px;
    margin-top: 50px;
}

.formBox, .listBox{
    background: white;
    padding: 20px;
    border-radius: 8px;
    width: 40%;
}

input{
    display: block;
    margin: 10px 0;
    padding: 8px;
    width: 100%;
}

button{
    padding: 8px 15px;
    background: blue;
    color: white;
    border: none;
    cursor: pointer;
    width: 400px;
    height: 50px;
}

.totalBox{
    margin-top: 20px;
    padding: 10px;
    background: #eef3ff;
    border-radius: 6px;
    text-align: center;
}

table{
    width: 80%;
}

td, th{
    padding: 8px;
    text-align: center;
}
.nav{
                width: 100%;
            padding: 20px 40px;
            
            display: flex;
            align-items: center;
            justify-content: space-between;
        
            
            background-color: #0b28e8;


            color: hsl(68, 87%, 54%);
            font-size: 18px;
            text-decoration: none;
           }
   </style>
</head>
<body>

 <div>
    <nav class="nav">
        <a href="#Digital Dukan ">Digital Dukan</a>

        <a href="#Backend online">Backend online</a>
    </nav>
    </div>

<div class="container">

    <div class="formBox">
        <h3>Add New Item</h3>
        <h4>Product Name</h4>

        <input id="name" placeholder="Product Name">
        <h5>Price</h5>
        <input id="price" type="number" placeholder="Price">
        <button onclick="addProduct()">Save to Inventory</button>

        
        <div class="totalBox">
            <h4>Total Inventory Value</h4>
            <p id="totalValue">₹ 0</p>
        </div>
    </div>

    <div class="listBox">
        <h3>Inventory List</h3>
        <table>
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Price</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody id="data"></tbody>
        </table>
    </div>

</div>


<script>

    
// Auto-detect API URL based on environment
const API = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1'
  ? 'http://localhost:3000'
  : window.location.origin;

console.log("API URL:", API);

function loadItem(){
  fetch(API + "/getproduct")
  .then(res => res.json())
  .then(data => {
    let rows = "";
    let total = 0;
    data.forEach(p => {
      total += Number(p.price);
      rows += `
        <tr>
          <td>${p.name}</td>
          <td>₹${p.price}</td>
          <td>
            <button onclick="updatePrice('${p._id}', ${p.price})">Update</button>
            <button onclick="deleteItem('${p._id}')">Delete</button>
          </td>
        </tr>
      `;
    });
    document.getElementById("data").innerHTML = rows;
    document.getElementById("totalValue").innerText = "₹ " + total;
  })
  .catch(err => console.log("Error loading items:", err));
}

function addProduct(){
  const name = document.getElementById("name").value;
  const price = document.getElementById("price").value;

  if(!name || !price) {
    alert("Please enter name and price");
    return;
  }

  fetch(API + "/addItem", {
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({ name, price })
  })
  .then(()=> {
    loadItem();
    document.getElementById("name").value="";
    document.getElementById("price").value="";
  })
  .catch(err => console.log("Error adding product:", err));
}

function updatePrice(id, oldPrice){
  const newPrice = prompt("Enter New Price", oldPrice);

  if(newPrice){
    fetch(API + "/updateprice/" + id, {
      method:"PUT",
      headers:{"Content-Type":"application/json"},
      body:JSON.stringify({ price:newPrice })
    })
    .then(()=> loadItem())
    .catch(err => console.log("Error updating price:", err));
  }
}

function deleteItem(id){
  if(confirm("Are you sure you want to delete this item?")){
    fetch(API + "/delete/" + id, {
      method:"DELETE"
    })
    .then(()=> loadItem())
    .catch(err => console.log("Error deleting item:", err));
  }
}

loadItem();




  
</script>

</body>
</html>




           




    


